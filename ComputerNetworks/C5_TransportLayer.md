# 传输层

## 概述

![image-20210624205854077](Images/image-20210624205854077.png)

![image-20210624205903448](Images/image-20210624205903448.png)

![image-20210624205914432](Images/image-20210624205914432.png)

![image-20210624205930328](Images/image-20210624205930328.png)

## UDP协议

UDP只在IP数据报服务之上增加了很少功能，即复用分用和差错检测功能。

特点: 

1. UDP是**无连接**的，减少开销和发送数据之前的时延。
2. UDP使用最大努力交付，即**不保证可靠交付**。
3. UDP是**面向报文**的，适合一次性传输少量数据的网络应用。
4. UDP无拥塞控制，适合很多实时应用。
5. UDP首部开销小，8B，TCP20B。

![image-20210624211058477](Images/image-20210624211058477.png)

![image-20210624211109127](Images/image-20210624211109127.png)

![image-20210624211123975](Images/image-20210624211123975.png)

![image-20210624211130903](Images/image-20210624211130903.png)

## TCP报文格式

![image-20210624214654705](Images/image-20210624214654705.png)

![image-20210624214726437](Images/image-20210624214726437.png)

![image-20210624214746701](Images/image-20210624214746701.png)

![image-20210624214756055](Images/image-20210624214756055.png)

## TCP三次握手, 四次挥手

![image-20210627195858994](Images/image-20210627195858994.png)

![image-20210627195911091](Images/image-20210627195911091.png)

![image-20210627195923258](Images/image-20210627195923258.png)

![image-20210627195943848](Images/image-20210627195943848.png)

## TCP可靠传输

![image-20210627203420003](Images/image-20210627203420003.png)

![image-20210627203431171](Images/image-20210627203431171.png)

TCP默认使用累计确认的方式

![image-20210627203523811](Images/image-20210627203523811.png)

## TCP流量控制

限制放松方

TCP利用滑动窗口机制实现流量控制

在通信过程中，接收方根据自己接收缓存的大小，动态地调整发送方的发送窗口大小，即接收窗口rwnd （接收方设置确认报文段的窗口字段来将rwnd通知给发送方），发送方的发送窗口取==接收窗口rwnd和拥塞窗口cwnd的最小值==。

![image-20210627204849012](Images/image-20210627204849012.png)

## TCP拥塞控制

![image-20210627211510388](Images/image-20210627211510388.png)

![image-20210627211518996](Images/image-20210627211518996.png)

![image-20210627211526114](Images/image-20210627211526114.png)

> 两组的主要区别就是修改门限值的时机, 第一组是发送主机检测到拥塞(例如频繁丢包.) 第二组是收到三组冗余ack