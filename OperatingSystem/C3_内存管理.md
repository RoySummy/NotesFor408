# 内存管理

[TOC]

## 内存基础知识

![image-20210807134403986](Images/image-20210807134403986.png)

### 逻辑地址 vs 物理地址

![image-20210807134514454](Images/image-20210807134514454.png)

### 从写程序到运行

![image-20210807134738001](Images/image-20210807134738001.png)

### 三种链接方式

![image-20210807134845348](Images/image-20210807134845348.png)

![image-20210807134929096](Images/image-20210807134929096.png)

![image-20210807135025483](Images/image-20210807135025483.png)

### 三种装入方式

![image-20210807135059171](Images/image-20210807135059171.png)

![image-20210807135126766](Images/image-20210807135126766.png)

![image-20210807135155917](Images/image-20210807135155917.png)

## 内存管理的概念

![image-20210807140010760](Images/image-20210807140010760.png)

### 内存空间的分配与回收

![image-20210807140055096](Images/image-20210807140055096.png)

### 内存空间的扩充（虚拟性）

![image-20210807140127892](Images/image-20210807140127892.png)

### 地址转换(装入方式)

![image-20210807140234558](Images/image-20210807140234558.png)

### 内存保护

> 操作系统需要提供==内存保护==功能。保证==各进程在各自存储空间内运行，互不干扰==

![image-20210807140339206](Images/image-20210807140339206.png)

![image-20210807140939045](Images/image-20210807140939045.png)

## 覆盖与交换=>扩充内存空间



![image-20210807141955371](Images/image-20210807141955371.png)

![image-20210807142051134](Images/image-20210807142051134.png)

### 覆盖

![image-20210807142115138](Images/image-20210807142115138.png)

![image-20210807142128698](Images/image-20210807142128698.png)

### 交换技术

![image-20210807142232748](Images/image-20210807142232748.png)

![image-20210807142247575](Images/image-20210807142247575.png)

## 连续分配管理

![image-20210807144333605](Images/image-20210807144333605.png)

![image-20210807144350526](Images/image-20210807144350526.png)

### 单一连续分配

![image-20210807144411813](Images/image-20210807144411813.png)

### 固定分区分配

![image-20210807144433924](Images/image-20210807144433924.png)

![image-20210807144450262](Images/image-20210807144450262.png)

### 动态分区分配

> ==动态分区分配（可变分区分配）==这种分配方式==不会预先划分内存分区==，而是在进程装入内存时， ==根据进程的大小动态地建立分区==，并使分区的==大小正好适合==进程的需要。因此系统分区的大小和数目是可变的。（eg：假设某计算机内存大小为64MB，系统区8MB，用户区共 56 MB…）
>
> ![image-20210807144946204](Images/image-20210807144946204.png)

#### 采用什么数据结构用来记录

![image-20210807144724339](Images/image-20210807144724339.png)

#### 分配算法

![image-20210807144741703](Images/image-20210807144741703.png)

![image-20210807150437651](Images/image-20210807150437651.png)

##### 首次适应

![image-20210807150534238](Images/image-20210807150534238.png)

##### 最佳适应

![image-20210807150601226](Images/image-20210807150601226.png)

##### 最坏适应(最大适应)

![image-20210807150655101](Images/image-20210807150655101.png)

##### 临近适应

![image-20210807150711203](Images/image-20210807150711203.png)

#### 如何回收

![image-20210807144847042](Images/image-20210807144847042.png)

![image-20210807144857252](Images/image-20210807144857252.png)

![image-20210807144905308](Images/image-20210807144905308.png)

![image-20210807144912982](Images/image-20210807144912982.png)

## 基本分页存储管理概念

![image-20210808101853466](Images/image-20210808101853466.png)

![image-20210808101914183](Images/image-20210808101914183.png)

### 什么是分页存储

![image-20210808102032436](Images/image-20210808102032436.png)

### 页表

![image-20210808102103315](Images/image-20210808102103315.png)

![image-20210808102118526](Images/image-20210808102118526.png)

![image-20210808102144733](Images/image-20210808102144733.png)

![image-20210808102217680](Images/image-20210808102217680.png)

![image-20210808102246563](Images/image-20210808102246563.png)

### 如何得到页号与页内偏移量

![image-20210808102335552](Images/image-20210808102335552.png)

![image-20210808102347751](Images/image-20210808102347751.png)

![image-20210808102402447](Images/image-20210808102402447.png)

![image-20210808102427333](Images/image-20210808102427333.png)

![image-20210808102445211](Images/image-20210808102445211.png)

## 基本地址变换机构

![image-20210808112048039](Images/image-20210808112048039.png)

![image-20210808112118907](Images/image-20210808112118907.png)

![image-20210808112136119](Images/image-20210808112136119.png)

![image-20210808112255365](Images/image-20210808112255365.png)

![image-20210808112310106](Images/image-20210808112310106.png)

![image-20210808112323642](Images/image-20210808112323642.png)

![image-20210808112336734](Images/image-20210808112336734.png)

## 具有快表的地址变换机构

![image-20210808115523310](Images/image-20210808115523310.png)

![image-20210808115550112](Images/image-20210808115550112.png)

### 什么是快表

![image-20210808115607051](Images/image-20210808115607051.png)

### 访存流程

![image-20210808115618876](Images/image-20210808115618876.png)

![image-20210808115627878](Images/image-20210808115627878.png)

![image-20210808115646098](Images/image-20210808115646098.png)

### 局部性原理

![image-20210808115656635](Images/image-20210808115656635.png)

## 两级页表

![image-20210808122029732](Images/image-20210808122029732.png)

### 单级页表存在的问题

![image-20210808122100315](Images/image-20210808122100315.png)

![image-20210808122113822](Images/image-20210808122113822.png)

### 页表过大解决方案

![image-20210808122214502](Images/image-20210808122214502.png)

![image-20210808122228869](Images/image-20210808122228869.png)

![image-20210808122243194](Images/image-20210808122243194.png)

### 常驻内存解决方案

![image-20210808122403317](Images/image-20210808122403317.png)

### 如何实现地址转换

![image-20210808122256842](Images/image-20210808122256842.png)

### 细节

![image-20210808122426387](Images/image-20210808122426387.png)

## 基本分段存储管理

![image-20210808140934657](Images/image-20210808140934657.png)

### 分段

![image-20210808141019818](Images/image-20210808141019818.png)

![image-20210808141045367](Images/image-20210808141045367.png)

### 段表

![image-20210808141113844](Images/image-20210808141113844.png)

### 地址变换

![image-20210808141134932](Images/image-20210808141134932.png)

![image-20210808141156120](Images/image-20210808141156120.png)

### 分段与分页的对比

![image-20210808141218523](Images/image-20210808141218523.png)

![image-20210808141234190](Images/image-20210808141234190.png)

![image-20210808141250551](Images/image-20210808141250551.png)

![image-20210808141300084](Images/image-20210808141300084.png)

## 段页式管理

![image-20210808143326731](Images/image-20210808143326731.png)

![image-20210808143349707](Images/image-20210808143349707.png)

### 分段+分页

![image-20210808143404068](Images/image-20210808143404068.png)

![image-20210808143425474](Images/image-20210808143425474.png)

### 段表、页表

![image-20210808143449073](Images/image-20210808143449073.png)

### 地址变换

![image-20210808143519003](Images/image-20210808143519003.png)

## 虚拟内存的基本概念

![image-20210808150830789](Images/image-20210808150830789.png)

### 传统存储管理的特征、缺点

![image-20210808150943992](Images/image-20210808150943992.png)

### 局部性原理

![image-20210808151805233](Images/image-20210808151805233.png)

### 虚拟内存的定义和特征

![image-20210808151828954](Images/image-20210808151828954.png)

![image-20210808151839508](Images/image-20210808151839508.png)

### 如何实现

![image-20210808151857517](Images/image-20210808151857517.png)

## 请求分页管理方式

![image-20210808154341415](Images/image-20210808154341415.png)

### 与基本分页的区别

![image-20210808154547267](Images/image-20210808154547267.png)

### 页表机制

![image-20210808154520917](Images/image-20210808154520917.png)

### 缺页中断机构

![image-20210808154635090](Images/image-20210808154635090.png)

![image-20210808154648365](Images/image-20210808154648365.png)

### 地址变换机构

![image-20210808154710538](Images/image-20210808154710538.png)

![image-20210808154720558](Images/image-20210808154720558.png)

![image-20210808153652324](Images/image-20210808153652324.png)

![image-20210808154734362](Images/image-20210808154734362.png)

## 页面置换算法

![image-20210808164243475](Images/image-20210808164243475.png)

### 最佳置换OPT

![image-20210808164316163](Images/image-20210808164316163.png)

> 际上，只有在进程执行的过程中才能知道接下来会访问到 的是哪个页面。操作系统无法提前预判页面访问序列。因此，最佳置换算法是无法实现的。

### 先进先出FIFO

![image-20210808164345390](Images/image-20210808164345390.png)

![image-20210808164358364](Images/image-20210808164358364.png)

### 最近最久未使用

![image-20210808164414749](Images/image-20210808164414749.png)

### 时钟置换CLOCK

![image-20210808164432811](Images/image-20210808164432811.png)

### 时钟置换升级版

![image-20210808164448488](Images/image-20210808164448488.png)

## 页面分配策略

![image-20210808165838145](Images/image-20210808165838145.png)

![image-20210808164841050](Images/image-20210808164841050.png)

![image-20210808165111758](Images/image-20210808165111758.png)

### 何时调入页面

![image-20210808170002715](Images/image-20210808170002715.png)

### 从何处调入

![image-20210808170022884](Images/image-20210808170022884.png)

### 抖动（颠簸）、工作集

![image-20210808170046572](Images/image-20210808170046572.png)

![image-20210808170055112](Images/image-20210808170055112.png)